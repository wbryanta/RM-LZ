{
  "meta": {
    "description": "LandingZone v0.2.x sprint toward 0.3.0",
    "version": "0.2.1-beta",
    "last_updated": "2025-11-15",
    "forensic_analysis_date": "2025-11-13",
    "notes": [
      "v0.1.3-beta: Mode toggle fixed, tasks board operational, max candidates configurable (25k-150k).",
      "v0.1.1-beta: Membership scoring system complete (commits 096d8c7, e15b486).",
      "Architecture: A- grade - game cache SSOT, lazy evaluation, two-phase filtering.",
      "Scoring: Fuzzy preference matching with continuous [0,1] memberships replaces k-of-n binary.",
      "Mutators: Quality-of-life scoring (83 mutators rated -10 to +10) integrated.",
      "UI: Default/Advanced mode toggle complete, stone selectors functional.",
      "Documentation: Architecture docs aligned with v0.1.* reality, obsolete v0.0.* docs archived.",
      "2025-11-14: Crisis freeze – default vs advanced logic rejecting all tiles; see _downloads/debug-log-14112025-2004.txt for evidence.",
      "2025-11-15: Sprint Kickoff – Simple/Advanced rearchitecture, preset hub, canonical coverage, UX overhaul."
    ],
    "principles": [
      "Game cache (Find.World.grid) as single source of truth - no duplication",
      "Two-phase filtering: Apply (hard Critical) \u2192 Score (soft Preferred)",
      "Lazy evaluation: expensive data only computed for survivors",
      "IndividualImportanceContainer: per-item importance (Granite=Critical, Marble=Preferred)",
      "Membership scoring: Fuzzy preferences (trapezoid falloff) replace binary cutoffs",
      "Score transparency: Users can inspect per-filter memberships and penalty impacts",
      "Quality over shortcuts: proper solutions, not hacks"
    ]
  },
  "milestones": {
    "0.1.0-beta": {
      "target_date": "2025-12-01",
      "theme": "Production-ready core with excellent UX",
      "critical_path": [
        "Stone filters completion",
        "Basic/Advanced UI mode",
        "Membership scoring implementation (5.5 days)",
        "Mutator quality scoring",
        "New filters (Animal/Fish)",
        "Filter validation updates",
        "Documentation cleanup"
      ]
    }
  },
  "in_progress": [],
  "todo": {
    "p0_critical": [
      {
        "id": "LZ-PRESET-HUB",
        "title": "Preset hub, Angel/Unicorn/Demon tiles, rarity scoring",
        "priority": "P0 - Critical",
        "estimate": "8-10 hours",
        "owner": "team",
        "description": "Simple mode should act as a preset launcher with curated bundles and user presets saved from Advanced. Presets leverage canonical rarity data to highlight Angel (quality), Unicorn (rarity), and Demon (challenge) tiles.",
        "deliverables": [
          "Grid layout showing Angel/Unicorn/Demon presets plus curated bundles",
          "Expose 'My Presets' generated from Advanced saves",
          "Each preset card shows high-level filters and key AND/OR relationships",
          "Compute tile rarity using aggregated world data (docs/data/canonical_world_library_aggregate.json) and log10 probabilities",
          "Show rarity badges (Common → Mythic) on presets/results",
          "Selecting a preset loads it into the Simple mode state and updates the search button context",
          "Document how to save/export presets between modes"
        ],
        "blockers": [
          "LZ-SIMPLE-ADV-SEPARATION"
        ],
        "area": "UI/UX/Data",
        "milestone": "0.2.1"
      },
      {
        "id": "LZ-UX-REORG",
        "title": "Advanced UI grouping & affordances",
        "priority": "P0 - Critical",
        "estimate": "10-12 hours",
        "owner": "team",
        "description": "Current Advanced layout mashes dozens of controls together with unclear indicators. Reorganize into logical sections with better feedback.",
        "deliverables": [
          "Categories: Environment, Flora & Fauna, Geography & Access, Resources & Structures, Challenges",
          "Show active counts that map to highlighted controls",
          "Hilliness/stone buttons gain tri-state colors/icons for Ignored/Preferred/Critical",
          "Range sliders grouped in bordered cards so their importance toggle is obvious",
          "Add helper text explaining AND vs OR logic per section"
        ],
        "blockers": [
          "LZ-SIMPLE-ADV-SEPARATION"
        ],
        "area": "UI/UX",
        "milestone": "0.2.2"
      },
      {
        "id": "LZ-CANONICAL-COVERAGE",
        "title": "Ensure every mutator/filter is surfaced",
        "priority": "P0 - Critical",
        "estimate": "8-10 hours",
        "owner": "team",
        "description": "Use docs/data/canonical_world_library_aggregate.json to ensure the UI exposes every discovered mutator/feature exactly once with friendly labels.",
        "deliverables": [
          "Create mapping (defName → friendly label, category, tooltip with rarity %)",
          "Remove duplicates (e.g., Rivers/Roads shouldn't also be in Map Features)",
          "Add missing entries such as LavaCrater, AncientRuins_Frozen, etc.",
          "Show rarity tooltip (e.g., 'LavaCrater – 0.0016% of settleable tiles')",
          "Automate future updates by loading the mapping in code"
        ],
        "blockers": [
          "LZ-UX-REORG"
        ],
        "area": "Data/UI",
        "milestone": "0.2.2"
      }
    ],
    "p1_high": [
      {
        "id": "LZ-ADV-SEARCH-FILTER",
        "title": "Advanced search & filter controls",
        "priority": "P1 - High",
        "estimate": "4-5 hours",
        "owner": "team",
        "description": "Make massive lists (Map Features, Adjacent Biomes, Stones) searchable and easier to multi-select.",
        "deliverables": [
          "Global search box that highlights matching controls across sections",
          "Dedicated search + filter for Map Features and Adjacent Biomes (shows '12 of 83 mutators')",
          "Two-column or chip-based layout so users aren't stuck scrolling",
          "Clear button to reset filters",
          "Keyboard navigation support"
        ],
        "blockers": [
          "LZ-UX-REORG"
        ],
        "area": "UI/UX",
        "milestone": "0.2.3"
      },
      {
        "id": "LZ-SCORE-LABEL-VALIDATION",
        "title": "Perfect tier validation & tests",
        "priority": "P1 - High",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "Ensure Perfect+/Perfect/Perfect- labels match base vs modifier math and never mislabel 1.000 scores.",
        "deliverables": [
          "Unit-style test or debug command that asserts label selection for representative tiles",
          "Clamp logic documented (base membership vs final score)",
          "Log entry when label is computed so QA can trace decisions",
          "Update README/UX doc with the precise label definitions"
        ],
        "blockers": [],
        "area": "Scoring/QA",
        "milestone": "0.2.3"
      }
    ],
    "p2_medium": [
      {
        "id": "LZ-FILTER-VERIFY-001",
        "title": "Verify CoastalLakeFilter neighbor detection",
        "priority": "P2 - Medium",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "CoastalLakeFilter uses heuristic neighbor detection. Need to verify against actual RimWorld grid API or implement proper neighbor traversal.",
        "current_state": "Filter checks 8 cardinal/diagonal neighbors using calculated offsets. May not match RimWorld's icosahedral grid geometry.",
        "deliverables": [
          "Research RimWorld's WorldGrid.GetNeighbors() or equivalent API",
          "Test current heuristic against known lake tiles",
          "If broken: implement proper neighbor detection",
          "Add test cases for various world seeds",
          "Document findings in code comments"
        ],
        "blockers": [],
        "area": "Filtering",
        "milestone": "0.1.0-beta"
      },
      {
        "id": "LZ-FILTER-VERIFY-002",
        "title": "Verify AdjacentBiomesFilter neighbor detection",
        "priority": "P2 - Medium",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "AdjacentBiomesFilter uses same heuristic as CoastalLakeFilter. Need to verify correctness.",
        "blockers": [
          "LZ-FILTER-VERIFY-001"
        ],
        "area": "Filtering",
        "milestone": "0.1.0-beta"
      },
      {
        "id": "LZ-MAPFEATURE-SAFETY",
        "title": "Add MapFeatureFilter reflection safety",
        "priority": "P2 - Medium",
        "estimate": "1 hour",
        "owner": "team",
        "description": "MapFeatureFilter uses reflection to access tile.Mutators. Add caching and error handling for robustness.",
        "deliverables": [
          "Cache PropertyInfo for Mutators on first access",
          "Add try-catch with graceful degradation",
          "Log warning if Mutators property not found",
          "Return empty list instead of crashing",
          "Add version compatibility note to code comments"
        ],
        "blockers": [],
        "area": "Filtering",
        "milestone": "0.1.0-beta"
      },
      {
        "id": "LZ-PRESET-SYSTEM",
        "title": "Implement preset save/load system",
        "priority": "P2 - Medium",
        "estimate": "6-8 hours",
        "owner": "team",
        "description": "Allow users to save/load filter configurations. Include 5-7 built-in presets.",
        "deliverables": [
          "Create FilterPreset.cs data model",
          "Create PresetManager.cs service (save/load/delete)",
          "Add preset dropdown to LandingZonePreferencesWindow",
          "Create 5-7 built-in presets: Easy Start, Balanced, Challenge, River Valley, Coastal Paradise, Mountain Fortress, Desert Nomad",
          "Store custom presets in RimWorld config directory",
          "Add import/export functionality for sharing"
        ],
        "blockers": [],
        "area": "UX",
        "milestone": "0.2.0"
      },
      {
        "id": "LZ-DIAGNOSTIC-WHY",
        "title": "'Why No Results?' diagnostic button",
        "priority": "P2 - Medium",
        "estimate": "4-5 hours",
        "owner": "team",
        "description": "When search returns 0 tiles, show diagnostic analysis of which filters eliminated the most tiles and suggest adjustments.",
        "deliverables": [
          "Track elimination counts per filter during Apply phase",
          "Show top 5 most restrictive filters",
          "Suggest: 'Try relaxing X filter' or 'Change X from Critical to Preferred'",
          "Add 'Analyze' button to results window when count == 0",
          "Display analysis in dialog or side panel"
        ],
        "blockers": [],
        "area": "UX",
        "milestone": "0.2.0"
      },
      {
        "id": "LZ-SCORING-UI-002",
        "title": "Score breakdown transparency UI",
        "priority": "P2 - Medium",
        "estimate": "4-5 hours",
        "owner": "team",
        "description": "Show per-filter memberships in results window. Users can see exactly why a tile scored high/low.",
        "deliverables": [
          "Add expandable 'Score Details' section to tile info panel in results window",
          "Show critical filters with membership: 'Temperature: 0.9 \u2605\u2605\u2605\u2605\u2606' (5-star visualization)",
          "Show preferred filters with membership and contribution to score",
          "Highlight worst critical: 'Growing season: 0.3 \u26a0\ufe0f (penalty applied: -40%)'",
          "Show mutator score contribution: 'Mutators: +0.05 (Geothermal +10, Polluted -5)'",
          "Display final score formula with actual values: 'Score = 0.6 \u00d7 (0.51\u00d70.82 + 0.39\u00d70.68 + 0.1\u00d70.55) = 0.73'",
          "Collapsible by default, expand on click"
        ],
        "blockers": [
          "LZ-SCORING-003"
        ],
        "area": "UI/UX",
        "milestone": "0.2.0"
      }
    ],
    "p3_low": [
      {
        "id": "LZ-UI-SEARCH-BOXES",
        "title": "Add search boxes to long lists",
        "priority": "P3 - Low",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "Add searchable list component for Map Features, Adjacent Biomes. Stone selector already has search (when rebuilt).",
        "deliverables": [
          "Add search box to Map Features selector",
          "Add search box to Adjacent Biomes selector",
          "Show filtered count (e.g., 'Showing 12 of 83 mutators')",
          "Clear button for search boxes"
        ],
        "blockers": [],
        "area": "UI",
        "milestone": "0.2.0"
      },
      {
        "id": "LZ-UI-SCROLLBAR",
        "title": "Polish scrollbar visibility",
        "priority": "P3 - Low",
        "estimate": "1 hour",
        "owner": "team",
        "description": "Current scrollbar works but could use visual polish. Low priority cosmetic improvement.",
        "blockers": [],
        "area": "UI/Polish",
        "milestone": "0.2.0"
      },
      {
        "id": "LZ-HEATMAP-OVERLAY",
        "title": "WorldLayer heatmap overlay visualization",
        "priority": "P3 - Low",
        "estimate": "8-10 hours",
        "owner": "team",
        "description": "Implement RimWorld WorldLayer to show top-scoring tiles as color-coded overlay on world map.",
        "deliverables": [
          "Create WorldLayerLandingZone : WorldLayer",
          "Render top N tiles with heat gradient (red=best, yellow=good, green=acceptable)",
          "Add toggle button in results window",
          "Handle world map panning and zooming",
          "Clear overlay when new search starts"
        ],
        "blockers": [],
        "area": "Visualization",
        "milestone": "0.3.0"
      },
      {
        "id": "LZ-UI-TOOLTIPS",
        "title": "Comprehensive tooltip pass",
        "priority": "P3 - Low",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "Ensure ALL filters have helpful, consistent tooltips. Most already have them, this is polish.",
        "deliverables": [
          "Audit all filters for missing tooltips",
          "Standardize tooltip format and tone",
          "Add examples where helpful (e.g., 'Granite: Strong, common')",
          "Add tooltip hover delay if too aggressive"
        ],
        "blockers": [],
        "area": "UI/Polish",
        "milestone": "0.2.0",
        "status": "todo"
      },
      {
        "id": "LZ-SCORING-UI-003",
        "title": "Drag-and-drop filter ranking UI",
        "priority": "Future",
        "estimate": "6-8 hours",
        "owner": "team",
        "description": "UI for explicit filter priority ordering. Users drag filters to reorder, weights auto-update.",
        "deliverables": [
          "Create reorderable list widget for critical filters",
          "Create reorderable list widget for preferred filters",
          "Add visual rank indicators (1st, 2nd, 3rd...)",
          "Weights auto-update on reorder: w_i = (n - r_i + 1)/n (linear decay)",
          "Save rank order in FilterSettings per filter",
          "Show weight preview as user drags: 'This filter will be 2.5\u00d7 more important than bottom-ranked'",
          "Add 'Reset to default order' button"
        ],
        "blockers": [
          "LZ-SCORING-003"
        ],
        "area": "UI/UX",
        "milestone": "0.3.0",
        "status": "todo"
      }
    ],
    "future": [
      {
        "id": "LZ-MUTATOR-CATEGORIES",
        "title": "Categorize 83 mutators in Advanced UI",
        "priority": "Future",
        "estimate": "4-5 hours",
        "owner": "team",
        "description": "In Advanced mode, organize 83 mutators into categories: Geological, Water, Resources, Climate, Wildlife, Ancient Sites, Hazards, Terrain.",
        "blockers": [
          "LZ-UI-MODE-001"
        ],
        "area": "UI",
        "milestone": "0.3.0"
      },
      {
        "id": "LZ-ADVANCED-RANKING",
        "title": "Advanced drag-to-order rankings with AND/OR logic",
        "priority": "Future",
        "estimate": "12-16 hours",
        "owner": "team",
        "description": "Advanced filter ranking system building on LZ-SCORING-UI-003. Adds boolean logic for complex filter combinations (e.g., 'River AND (Coastal OR Lake)').",
        "deliverables": [
          "Extend drag-to-order UI from LZ-SCORING-UI-003 with logic operators",
          "Add AND/OR/NOT operators between filter groups",
          "Visual logic tree builder with parentheses grouping",
          "Support complex expressions: '(Temperature AND Rainfall) OR (Coastal AND River)'",
          "Real-time membership score preview as logic changes",
          "Convert logic tree to scoring weights: AND = multiplication, OR = max, NOT = 1-x",
          "Validate logic expressions for consistency (no contradictions)",
          "Save/load complex logic expressions as presets",
          "Add logic expression templates: 'Balanced', 'Strict Requirements', 'Flexible Preferences'",
          "Show visual graph of how logic affects score distribution"
        ],
        "blockers": [
          "LZ-SCORING-UI-003"
        ],
        "area": "UI/UX",
        "milestone": "0.4.0"
      }
    ]
  },
  "completed": [
    {
      "id": "LZ-SIMPLE-ADV-SEPARATION",
      "title": "Separate Simple vs Advanced filter states",
      "priority": "P0 - Critical",
      "owner": "team",
      "completed": "2025-11-15",
      "impact": "Simple and Advanced modes now maintain independent FilterSettings that persist across sessions. Users can copy settings between modes via import/export buttons. Search button shows active mode context. Eliminates confusion from shared state.",
      "area": "UI/Architecture",
      "files_modified": [
        "Source/Data/UserPreferences.cs (added SimpleFilters/AdvancedFilters with GetActiveFilters)",
        "Source/Data/LandingZoneOptions.cs (renamed UIMode.Default → UIMode.Simple)",
        "Source/Data/FilterSettings.cs (added CopyFrom method)",
        "Source/Core/Filtering/FilterContext.cs (added Filters convenience property)",
        "Source/Core/UI/LandingZonePreferencesWindow.cs (renamed methods, added import/export buttons, added helper text)",
        "Source/Core/UI/DefaultModeUI.cs (added import from Advanced button)",
        "Source/Core/UI/SelectStartingSiteButtonsPatch.cs (search button shows mode context)",
        "README.md (updated with Simple/Advanced independence docs)"
      ],
      "description": "Renamed 'Default' to 'Simple' throughout codebase. Added dual FilterSettings (SimpleFilters/AdvancedFilters) to UserPreferences with GetActiveFilters() helper. Updated all filter references to use mode-appropriate settings via context.Filters. Added CopyFrom() reflection-based method to FilterSettings. Added import/export buttons in both modes. Added helper text explaining mode independence. Search button now displays '(Simple)' or '(Advanced)' context."
    },
    {
      "id": "LZ-BOOKMARK-MATERIAL",
      "title": "WorldLayerBookmarks static constructor",
      "priority": "P0 - Critical",
      "owner": "team",
      "completed": "2025-11-15",
      "impact": "Removed startup warning by loading bookmark material on the main thread via StaticConstructorOnStartup.",
      "area": "UI/Infrastructure",
      "files_modified": ["Source/Core/WorldLayerBookmarks.cs"],
      "description": "Added [StaticConstructorOnStartup] to WorldLayerBookmarks and initialized _bookmarkMaterial via LongEventHandler ExecuteWhenFinished to satisfy Unity asset loading rules."
    },
    {
      "id": "LZ-CANDIDATE-CAP-OVERHAUL",
      "title": "Max Candidate guardrails + Unlimited option",
      "priority": "P0 - Critical",
      "owner": "team",
      "completed": "2025-11-15",
      "impact": "Users can choose Unlimited (all tiles) while lower presets warn when the cap truncates candidates; Stage B telemetry added.",
      "area": "Filtering/UX",
      "files_modified": ["Source/Core/Filtering/BitsetAggregator.cs", "Source/Core/Filtering/FilterService.cs", "Source/LandingZoneSettings.cs"],
      "description": "Added Unlimited option with warnings/tooltips, bumped default tiles-per-frame to 500, and logged Stage B processing/time including cap hits."
    },
    {
      "id": "LZ-CRISIS-SCORING-VALIDATION",
      "title": "Membership scoring telemetry",
      "priority": "P0 - Critical",
      "owner": "team",
      "completed": "2025-11-15",
      "impact": "FilterService now logs per-run candidate counts and Stage B completion, enabling QA to verify membership scoring health.",
      "area": "Filtering/Diagnostics",
      "files_modified": ["Source/Core/Filtering/FilterService.cs"],
      "description": "Added Stage B telemetry, gated K-of-N logging to legacy mode, and updated results labels to align with membership scoring."
    },
    {
      "id": "LZ-LOGIC-001",
      "title": "Fix AND/OR operator logic for IndividualImportanceContainer filters",
      "priority": "P0 - Critical",
      "estimate": "8-10 hours",
      "owner": "team",
      "description": "Fixed critical bug where Default mode 'Any' selections (Rivers, Roads, Map Features) enforced impossible AND logic requiring tiles to have ALL river types simultaneously. Implemented OR operator support and aligned membership scoring with Apply phase.",
      "deliverables": [
        "Added ImportanceOperator enum (AND/OR) to IndividualImportanceContainer",
        "Updated MeetsCriticalRequirements() to respect operator: OR = any match, AND = all matches",
        "Added GetCriticalSatisfaction() for operator-aware proportional scoring",
        "DefaultModeUI sets OR operator for 'Any River/Road' selections",
        "AdvancedModeUI exposes operator toggle buttons for all 5 containers (Rivers, Roads, Stones, MapFeatures, AdjacentBiomes)",
        "Fixed MapFeatureFilter.Membership() to use GetCriticalSatisfaction() and count preferred matches",
        "Fixed RiverFilter.Membership() to use GetCriticalSatisfaction() with OR/AND logic",
        "Instrumented GetTileMapFeatures() with comprehensive DevMode diagnostics",
        "Removed Map Features 20-item hard cap, replaced with 400px scrollable view",
        "All changes compile cleanly (0 errors, 35 pre-existing warnings)"
      ],
      "impact": "Critical bug fix enabling 'Any River = Critical' to work correctly. Users can now find tiles with ANY river type instead of requiring ALL types (impossible). Scoring now aligns with filtering logic. Map features fully accessible in Advanced UI.",
      "area": "Filtering/Scoring/UI",
      "milestone": "Crisis-Freeze",
      "status": "completed",
      "completed": "2025-11-15",
      "files_modified": [
        "Source/Data/IndividualImportanceContainer.cs (added operator support)",
        "Source/Core/UI/DefaultModeUI.cs (set OR for 'Any' selections)",
        "Source/Core/UI/AdvancedModeUI.cs (added scroll position state)",
        "Source/Core/UI/AdvancedModeUI_Controls.cs (operator toggles + scrollable map features)",
        "Source/Core/Filtering/Filters/MapFeatureFilter.cs (fixed Membership + instrumentation)",
        "Source/Core/Filtering/Filters/RiverFilter.cs (fixed Membership)"
      ]
    },
    {
      "id": "LZ-BOOKMARKS",
      "title": "Bookmarks manager for favorite tiles",
      "priority": "P2 - Medium",
      "estimate": "8-10 hours",
      "owner": "team",
      "description": "Allow users to bookmark interesting tiles for later review. Bookmarks persist across sessions and show on world map.",
      "deliverables": [
        "Create BookmarkManager.cs service for CRUD operations",
        "Create TileBookmark.cs data model (tile ID, name, notes, color, timestamp)",
        "Add 'Bookmark This Tile' button to results window",
        "Create bookmarks list window (show all, filter, sort, delete)",
        "Add bookmark annotations to world map (colored markers with labels)",
        "Persist bookmarks via Scribe in game save file",
        "Add 'Jump to Bookmark' functionality",
        "Support custom bookmark colors and categories",
        "Add 'Export Bookmarks' (share with friends)"
      ],
      "blockers": [],
      "area": "UX",
      "milestone": "0.2.0",
      "status": "completed",
      "completed": "2025-11-14"
    },
    {
      "id": "LZ-FIX-STATUS-INFO",
      "title": "Add total tiles and inhabitable tiles to status display",
      "priority": "P1 - High",
      "estimate": "1-2 hours",
      "owner": "team",
      "description": "Status area below buttons should show total world tiles and total inhabitable tiles for context. Found during testing (2025-11-13).",
      "deliverables": [
        "Add world tile count to status display: 'World: 156,231 tiles'",
        "Add inhabitable tile count: '42,183 inhabitable (27%)'",
        "Calculate inhabitable: tiles where biome != Ocean, SeaIce, Lake",
        "Update DrawEvaluationStatus() in SelectStartingSiteButtonsPatch.cs",
        "Format numbers with thousand separators for readability",
        "Show this info when NOT evaluating (complementing progress/results)"
      ],
      "blockers": [],
      "area": "UI",
      "milestone": "0.1.1-beta",
      "status": "completed"
    },
    {
      "id": "LZ-FIX-BASIC-ROADS-RIVERS",
      "title": "Add Rivers & Roads toggles to Basic interface",
      "priority": "P1 - High",
      "estimate": "1-2 hours",
      "owner": "team",
      "description": "Add simplified Rivers/Roads filters to Basic mode. Toggles enable ALL types (not per-type selection like Advanced mode).",
      "deliverables": [
        "Add 'Rivers (Any)' tri-state toggle to DefaultModeUI.cs",
        "Add 'Roads (Any)' tri-state toggle to DefaultModeUI.cs",
        "When set to Preferred/Critical, enable ALL types in FilterSettings.Rivers/Roads",
        "Position after 'Coastal' toggle, before 'Growing Season' slider",
        "Add tooltips: 'Any river type' / 'Any road type'",
        "Test: Verify toggling enables all river/road types in filter results"
      ],
      "blockers": [],
      "area": "UI",
      "milestone": "0.1.1-beta",
      "status": "completed"
    },
    {
      "id": "LZ-FIX-TEMPERATURE-CF",
      "title": "Honor Celsius/Fahrenheit user setting in Basic UI",
      "priority": "P1 - High",
      "estimate": "1-2 hours",
      "owner": "team",
      "description": "Read Prefs.TemperatureMode and display temperature ranges in user's chosen unit (Celsius/Fahrenheit/Kelvin). Storage remains Celsius internally.",
      "deliverables": [
        "Read RimWorld's Prefs.TemperatureMode setting",
        "Update DefaultModeUI.cs temperature slider labels to show correct unit",
        "Convert slider values on-the-fly for display (storage stays Celsius)",
        "Update tooltips to match displayed unit",
        "Test with all 3 temperature modes (C/F/K)",
        "Ensure conversion is accurate (C\u2194F: F = C\u00d71.8+32)"
      ],
      "blockers": [],
      "area": "UI",
      "milestone": "0.1.1-beta",
      "status": "completed"
    },
    {
      "id": "LZ-DOCS-CLEANUP",
      "title": "Update documentation to reflect current reality",
      "completed": "2025-11-13",
      "impact": "Complete documentation overhaul aligned with v0.1.* architecture. Archived obsolete v0.0.* docs (WorldSnapshot, deleted filters). Created comprehensive docs/architecture-v0.1-beta.md (327 lines). Updated CLAUDE.md with membership scoring details. Rewrote README.md from scaffolding stub to full feature documentation. Created DOCS_AUDIT_REPORT.md with forensic findings. Updated tasks.json meta to v0.1.3-beta. All documentation now accurately reflects current reality: membership scoring, game cache SSOT, IndividualImportanceContainer pattern, mutator quality scoring, Default/Advanced UI modes.",
      "area": "Documentation"
    },
    {
      "id": "LZ-FIX-MODE-TOGGLE",
      "title": "Fix Default/Advanced mode toggle buttons",
      "completed": "2025-11-13",
      "impact": "Fixed mode toggle buttons that were non-functional due to Widgets.ButtonText 'active' parameter preventing clicks. Removed 'active' parameter, added visual feedback (light green tint for active mode), added guard logic to prevent redundant switches. Mode now switches correctly between Default/Advanced with proper UI re-rendering.",
      "area": "UI"
    },
    {
      "id": "LZ-UI-MODE-FOUNDATION",
      "title": "Phase 1: Dual-mode UI foundation (Default/Advanced)",
      "completed": "2025-11-13",
      "impact": "Added UIMode enum to LandingZoneOptions. Created DefaultModeUI and AdvancedModeUI stub renderers. Added mode toggle to preferences window. Mode preference persists. Clean foundation for Phase 2A/2B implementation.",
      "area": "UI"
    },
    {
      "id": "LZ-CLEANUP-002",
      "title": "Phase 1.5: Evidence-based dead code removal",
      "completed": "2025-11-13",
      "impact": "Forensic analysis identified dual evaluation paths. Removed ~373 LOC: BranchAndBoundScorer (167 LOC), FilterService.Evaluate() method (144 LOC), deprecated helper methods (62 LOC). Simplified HighlightService. Only active FilterEvaluationJob path remains. Build verified clean.",
      "area": "Cleanup"
    },
    {
      "id": "LZ-CLEANUP-001",
      "title": "Initial forensic analysis and dead code removal",
      "completed": "2025-11-13",
      "impact": "Removed TriStateFilter, MultiSelectFilterContainer (305 LOC). Generated 3 analysis documents (FORENSIC_ANALYSIS.md, ANALYSIS_QUICK_REFERENCE.md, ANALYSIS_INDEX.md). Rebuilt tasks.json with clean slate priorities. NOTE: BitsetAggregator and PrecomputedBitsetCache initially deleted but restored after validation - they are actively used by FilterEvaluationJob.",
      "area": "Infrastructure"
    },
    {
      "id": "LZ-ARCH-GAME-CACHE",
      "title": "Remove WorldSnapshot - use game cache as SSOT",
      "completed": "2025-11-13",
      "impact": "Major architecture simplification. Eliminated memory duplication, 150ms init cost, development confusion.",
      "area": "Architecture"
    },
    {
      "id": "LZ-CAVE-BUG-FIX",
      "title": "Fix cave filtering bug - remove HasCaveFilter heuristic",
      "completed": "2025-11-13",
      "impact": "Cave filtering now 100% accurate using game's actual Mutator data.",
      "area": "Filtering"
    },
    {
      "id": "LZ-KOFN-BUGS",
      "title": "Fix k-of-n architecture bugs in 12 filters",
      "completed": "2025-11-11",
      "impact": "Apply() now only filters Critical, allowing Preferred to reach scoring phase.",
      "area": "Filtering"
    },
    {
      "id": "LZ-SPRINT-1-1",
      "title": "Sprint 1.1: Delete all deprecated FilterSettings properties",
      "completed": "2025-11-13",
      "impact": "Removed TemperatureRange, individual stone properties, RequiredStoneDefNames, RiverImportance, RoadImportance, etc. Deleted TemperatureFilter, IndividualStoneFilter, SpecificStoneFilter, StoneCountFilter.",
      "area": "Cleanup"
    },
    {
      "id": "LZ-UI-MODE-001",
      "title": "Phase 2A: Default mode UI implementation",
      "completed": "2025-11-13",
      "impact": "Implemented Default mode UI with 8 essential filters. Created AdvancedModeUI with all 16 filters including multi-select containers. Stone selectors working in Advanced mode with per-stone importance. UI mode toggle functional with mode-specific rendering. Commit: 096d8c7",
      "area": "UI"
    },
    {
      "id": "LZ-SCORING-001",
      "title": "Create MembershipFunctions utility library",
      "completed": "2025-11-13",
      "impact": "Created MembershipFunctions.cs with trapezoid (numeric ranges), distance decay, binary, and ordinal category membership functions. Foundation for fuzzy preference matching. 141 LOC. Commit: 096d8c7",
      "area": "Scoring"
    },
    {
      "id": "LZ-SCORING-002",
      "title": "Add Membership() to ISiteFilter and all 16 filters",
      "completed": "2025-11-13",
      "impact": "Added Membership() method signature to ISiteFilter interface. Implemented in all 16 filters: trapezoid for numeric ranges (Rainfall, Temperature, Elevation, etc.), binary for boolean checks (Coastal, HasCave, etc.), set-based for multi-select containers (Rivers, Roads, Biomes, etc.). Enables continuous [0,1] scoring. Commit: 096d8c7",
      "area": "Scoring"
    },
    {
      "id": "LZ-SCORING-003",
      "title": "Integrate membership scoring into FilterService",
      "completed": "2025-11-13",
      "impact": "Added ScoringWeights methods: ComputeGroupScore, ComputeWorstCritical, ComputePenalty, ComputeGlobalWeights, ComputeMembershipScore. Integrated into FilterEvaluationJob with feature flag (UseNewScoring). Complete pipeline: collect memberships \u2192 group scores (S_C, S_P) \u2192 penalty term (P_C) \u2192 global weights (\u03bb_C, \u03bb_P, \u03bb_mut) \u2192 final score. Replaces k-of-n binary matching with fuzzy preferences. Commit: 096d8c7",
      "area": "Scoring"
    },
    {
      "id": "LZ-SCORING-005",
      "title": "Mutator quality scoring integration",
      "completed": "2025-11-13",
      "impact": "Created MutatorQualityRatings.cs with 83 mutators rated -10 (very bad) to +10 (very good). ComputeMutatorScore() uses tanh squashing: S_mut = 0.5 \u00d7 (1 + tanh(0.25 \u00d7 Q_raw)). Integrated into membership scoring with \u03bb_mut = 0.1 weight. Geothermal vents, fertile soil boost scores; toxic lakes, lava craters reduce scores. Made MapFeatureFilter.GetTileMapFeatures() internal for access. 184 LOC. Commit: e15b486",
      "area": "Scoring"
    },
    {
      "id": "LZ-VALIDATION-001",
      "title": "Update FilterValidator for IndividualImportanceContainer",
      "completed": "2025-11-13",
      "impact": "Fixed FilterValidator.cs to use CountByImportance(FilterImportance.Critical/Preferred) methods instead of non-existent CriticalCount/PreferredCount properties. Added comprehensive counting logic for Rivers, Roads, Stones, MapFeatures, AdjacentBiomes, WorldFeatures. Build clean: 0 errors, 0 warnings. Commit: 096d8c7",
      "area": "Validation"
    }
  ],
  "areas": {
    "Architecture": "Core system design and patterns",
    "Filtering": "Filter implementations and logic",
    "UI": "User interface components",
    "UX": "User experience and workflows",
    "Validation": "Filter validation and diagnostics",
    "Documentation": "Code and user documentation",
    "Infrastructure": "Build, deployment, tooling",
    "Visualization": "World map overlays and visual feedback",
    "Scoring": "Tile ranking algorithms",
    "Cleanup": "Dead code removal and refactoring"
  },
  "blocked": {
    "p1_high": [
      {
        "id": "LZ-RESULTS-REFACTOR",
        "title": "Results window UX refactor",
        "priority": "P1 - High",
        "estimate": "6-8 hours",
        "owner": "team",
        "description": "Refactor LandingZoneResultsWindow for better organization, readability, and extensibility.",
        "blockers": [
          "Core filter/scoring correctness unresolved as of 2025-11-14 freeze"
        ],
        "area": "UI/UX",
        "milestone": "0.2.0",
        "status": "blocked"
      },
      {
        "id": "LZ-FIX-LOGGING-LEVELS",
        "title": "Add logging level control to Mod Settings",
        "priority": "P1 - High",
        "estimate": "1-2 hours",
        "owner": "team",
        "description": "Reduce log spam by adding Verbose/Standard/Brief logging levels. Default: Standard (reduces thousands of lines to ~10-20 per search).",
        "deliverables": [
          "Add LoggingLevel enum to LandingZoneModSettings.cs (Verbose/Standard/Brief)",
          "Update tile-level logging in FilterService.cs:",
          "  - Verbose: Log every tile evaluation (current behavior - floods log)",
          "  - Standard: Log phase summaries only (~10-20 lines per search) [DEFAULT]",
          "  - Brief: Log final results count and timing only (~3-5 lines)",
          "Add Mod Settings dropdown with tooltip explaining each level",
          "Test: Verify Standard reduces log output from 1000s of lines to ~10-20",
          "Ensure critical errors still logged regardless of level"
        ],
        "blockers": [],
        "area": "Infrastructure/Settings",
        "milestone": "0.1.1-beta",
        "status": "blocked"
      },
      {
        "id": "LZ-FIX-PRESETS-GRID",
        "title": "Expand presets to 3x3 grid (9 presets)",
        "priority": "P1 - High",
        "estimate": "3-4 hours",
        "owner": "team",
        "description": "Expand Default mode presets to 3x3 grid with collapse toggle once core filter correctness is restored.",
        "blockers": [
          "Deprioritized until crisis tasks complete"
        ],
        "area": "UI/UX",
        "milestone": "0.1.1-beta",
        "status": "blocked"
      },
      {
        "id": "LZ-FIX-SCORING-WEIGHTS",
        "title": "Implement 5 scoring weight presets in Mod Settings",
        "priority": "P1 - High",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "Add dropdown in Mod Settings for 5 scoring weight presets. Provides user control over critical:preferred:bonus hierarchy. Default: 'Critical Focused' (10:3:1).",
        "deliverables": [
          "Create LandingZoneModSettings.cs extending ModSettings",
          "Add ScoringWeightPreset enum with 5 presets:",
          "  - Balanced (7:2:1): critBase=4.0, prefBase=1.0, mutWeight=0.1",
          "  - Critical Focused (10:3:1): critBase=3.35, prefBase=1.0, mutWeight=0.071 [DEFAULT]",
          "  - Strict Hierarchy (16:4:1): critBase=4.0, prefBase=1.0, mutWeight=0.05",
          "  - Ultra Critical (20:4:1): critBase=5.0, prefBase=1.0, mutWeight=0.04",
          "  - Precision Match (5:1:0): critBase=5.0, prefBase=1.0, mutWeight=0.0",
          "Update FilterService.cs to read preset values instead of hardcoded constants",
          "Add Mod Settings UI with dropdown + tooltips explaining each preset",
          "Implement ExposeData() for persistence",
          "Test: Verify switching presets changes scoring behavior"
        ],
        "blockers": [],
        "area": "Scoring/Settings",
        "milestone": "0.1.1-beta",
        "status": "blocked"
      }
    ],
    "p3_low": [
      {
        "id": "LZ-UI-KEYBOARD",
        "title": "Add keyboard shortcuts",
        "priority": "P3 - Low",
        "estimate": "2-3 hours",
        "owner": "team",
        "description": "Add keyboard shortcuts for common operations (Space=toggle section, Enter=search, Ctrl+R=reset, etc.).",
        "blockers": [],
        "area": "UX/Polish",
        "milestone": "0.2.0",
        "status": "blocked"
      }
    ],
    "p2_medium": [
      {
        "id": "LZ-MOD-SETTINGS",
        "title": "Comprehensive mod settings menu",
        "priority": "P2 - Medium",
        "estimate": "5-6 hours",
        "owner": "team",
        "description": "Create comprehensive RimWorld Mod Settings menu for all configurable options (beyond just scoring parameters in LZ-SCORING-UI-001). Includes performance, UI, and feature toggles.",
        "deliverables": [
          "Create LandingZoneModSettings.cs extending ModSettings",
          "Add performance settings: max results limit, evaluation timeout, cache size",
          "Add UI settings: window opacity, font size, default mode (Default/Advanced)",
          "Add feature toggles: UseNewScoring (already exists), enable heatmap, enable bookmarks",
          "Add debug settings: verbose logging, show evaluation metrics, diagnostic mode",
          "All settings persist via Scribe system",
          "Settings accessible via RimWorld Mod Settings menu",
          "Add 'Reset All to Defaults' button"
        ],
        "blockers": [],
        "area": "UI/UX",
        "milestone": "0.2.0",
        "status": "blocked"
      },
      {
        "id": "LZ-TELEMETRY",
        "title": "End-user troubleshooting telemetry",
        "priority": "P2 - Medium",
        "estimate": "6-8 hours",
        "owner": "team",
        "description": "Add opt-in telemetry and diagnostic tools to help users troubleshoot issues without needing to read Player.log. Helpful for bug reports and support.",
        "deliverables": [
          "Create DiagnosticLogger.cs with ring buffer for recent events",
          "Track: search start/end, filter application times, exceptions, performance metrics",
          "Add 'Copy Diagnostics' button to preferences window (copies to clipboard)",
          "Format: anonymized, human-readable, timestamp-prefixed log",
          "Add session stats: searches performed, avg search time, cache hit rate, errors",
          "Add 'Performance Report' showing bottleneck analysis",
          "Opt-in via mod settings (default enabled, easily disableable)",
          "Include mod version, RimWorld version, DLC detection in diagnostics",
          "Never log user filter preferences or world seed (privacy)"
        ],
        "blockers": [],
        "area": "Infrastructure",
        "milestone": "0.2.0",
        "status": "blocked"
      },
      {
        "id": "LZ-SCORING-UI-001",
        "title": "Mod settings for scoring parameters",
        "priority": "P2 - Medium",
        "estimate": "3-4 hours",
        "owner": "team",
        "description": "Expose tuning knobs in RimWorld Mod Settings menu. Complex math stays under the hood, but power users get control.",
        "deliverables": [
          "Add slider for \u03b1_pen (penalty floor): range 0.0-0.3, default 0.1, tooltip 'How much score survives worst critical miss'",
          "Add slider for \u03b3_pen (penalty sharpness): range 1.0-4.0, default 2.0, tooltip 'How harshly worst critical is punished'",
          "Add slider for \u03bb_mut (mutator weight): range 0.0-0.3, default 0.1, tooltip 'How much mutators influence score'",
          "Add slider for fuzzy margin multiplier: range 0.5-2.0, default 1.0, tooltip 'Widens/narrows acceptable range for numeric filters'",
          "Changes apply immediately to next search",
          "Add 'Reset to defaults' button"
        ],
        "blockers": [
          "LZ-SCORING-003"
        ],
        "area": "UI/UX",
        "milestone": "0.2.0",
        "status": "blocked"
      }
    ]
  },
  "archived": [
    {
      "id": "LZ-FIX-PREFS-LABEL",
      "title": "Update LZ Prefs button label to show preset name",
      "priority": "P1 - High",
      "estimate": "1-2 hours",
      "owner": "team",
      "description": "LZ Prefs button should show 'default', 'preset01', 'preset02', etc. or 'custom01', 'custom02' for saved filters (max 99 each). Found during testing (2025-11-13).",
      "deliverables": [
        "Add preset tracking to GameState or LandingZoneOptions",
        "Track which preset is active (default, Temperate=01, ArcticChallenge=02, etc.)",
        "Track custom saved filter slots (1-99)",
        "Update GetPresetDisplayName() in SelectStartingSiteButtonsPatch.cs",
        "Format: 'default', 'preset01', 'preset02', ... 'preset99', 'custom01', ... 'custom99'",
        "Update label on preset load/save/reset"
      ],
      "blockers": [],
      "area": "UI",
      "milestone": "0.1.1-beta",
      "status": "archived"
    },
    {
      "id": "LZ-STONE-001",
      "title": "Complete stone filter UI rebuild",
      "completed": "2025-11-13",
      "impact": "Stone filter UI fully implemented in both Default and Advanced modes. Default mode shows Granite/Marble selectors. Advanced mode dynamically loads all stone types from DefDatabase<ThingDef>, provides individual importance selectors, and includes Stone Count mode with range slider. All deliverables met: uses IndividualImportanceContainer pattern, no TODOs remaining, results window displays stone types. Users can now filter by specific stones (e.g., Granite=Critical, Marble=Preferred). NOTE: 2025-11-14 regression tracked by LZ-CRISIS-OR-LOGIC reintroduces AND-vs-OR issues for multi-select filters.",
      "area": "Filtering/UI",
      "status": "archived"
    }
  ]
}
